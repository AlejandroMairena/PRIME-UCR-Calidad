@page "/user_administration/profiles"
@using PRIME_UCR.Components.UserAdministration.ProfilesModifications
@using ChartJs.Blazor.Charts
@using PRIME_UCR.Application.Implementations.UserAdministration;
@using PRIME_UCR.Domain.Constants

@attribute [HasPermission(AuthorizationPermissions.CanManageUsers)]

<link href="css/Profiles.css" rel="stylesheet" />


<br />
<h3> Modificación de Permisos y Perfiles </h3>
<br />

<StatusMessage Message="@profile.StatusMessage" Class="@profile.StatusMessageType" />

<div class="rounded" style="background-color: white;padding: 10px">
    <h5>Perfiles</h5>
    <ProfilesComponent @bind-Value="profile" />
</div>

<br />

@if (!String.IsNullOrEmpty(profile.ProfileName))
{
    <Loading IsLoading="profile.ProfileName == null || isLoading == true">
        <div class="wrapper">
            <div class="rounded" style="background-color: white;padding-left: 10px;padding-right: 10px;">
                <br />
                <h5>Usuarios</h5>
                <UsersComponent @bind-Value="profile"
                                isLoading="isLoading"
                                isLoadingChanged="() => { isLoading = !isLoading; StateHasChanged(); }"/>
            </div>
            <div class="rounded" style="background-color:white;padding-left: 10px;padding-right: 10px;">
                <br />
                <h5>Permisos</h5>
                <PermissionsComponent @bind-Value="profile" 
                                      isLoading="isLoading"
                                      isLoadingChanged="()=> { isLoading = !isLoading; StateHasChanged(); }"/>
            </div>

        </div>
    </Loading>

}